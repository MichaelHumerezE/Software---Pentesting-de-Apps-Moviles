@extends('administrador.admin')
@section('content')
    <style>
        .resizable-textarea {
            resize: none;
            /* Deshabilita la redimensión manual del usuario */
            overflow: hidden;
            /* Oculta cualquier desbordamiento del contenido */
        }
    </style>

    <script>
        function ajustarAlturaTexto(textarea) {
            textarea.style.height = 'auto'; // Restablece la altura a automática
            textarea.style.height = textarea.scrollHeight + 'px'; // Ajusta la altura al contenido
        }
    </script>

    <div class="card mt-3">
        <div class="card-header">
            <h1 class="text-center font-bold text-xl">Análisis Camino Básico</h1>
        </div>
        <div class="card-header">
            <h1 class="text-center font-bold text-xl">Grafo de Flujo</h1>
        </div>
        <div id="graph-container" class="text-center"></div>
        <div class="card-body">
            <form action="{{ route('analisisCbasico.ver') }}" method="GET" enctype="multipart/form-data" id="create">
                @csrf
                @include('layouts.messages')
                <div class="card-header">
                    <h1 class="text-center font-bold text-xl">Complejidad Ciclomática V(G)</h1>
                </div>
                 <div class="content">
                    <div class="row">
                        <div class="col-12">
                            <p>Complejidad Ciclomática V(G):</p>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <p>{{$generatedText}}</p>
                        </div>
                    </div>
                </div>
                <div class="card-header">
                    <h1 class="text-center font-bold text-xl">Tabla de Caminos</h1>
                </div>
                <div id="center-container" style="display: flex; justify-content: center; align-items: center;">
                    {!! $generatedTextTable !!}
                </div>
                <input type="hidden" name="tipoc" class="form-control" id="tipoc" value="0">
                <input type="hidden" name="tipoe" class="form-control" id="tipoe" value="1">
            </form>
        </div>
        <div class="card-header d-inline-flex">
            <a href="{{ route('analisisCbasico.index') }}" class="btn btn-primary ml-auto">
                <i class="fas fa-arrow-left"></i>
                Volver</a>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/viz.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/full.render.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/lite.render.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/viz.es.js"></script>
    <script type="module">
        var graph = <?php echo json_encode($generatedTextGraph); ?>;
        // Función para generar el grafo a partir de una descripción DOT
        function generateGraph() {
            const dot = graph;

            const viz = new Viz();
            viz.renderSVGElement(dot)
                .then(element => {
                    document.getElementById('graph-container').appendChild(element);
                });
        }

        window.onload = generateGraph;
    </script>
           
@endsection